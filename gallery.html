<!DOCTYPE HTML>
<html>
	<head>
		<title>–§–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è ‚Äî Zhetysai Ibilim 10C</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			/* Gallery Styles */
			.gallery-hero {
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				padding: 70px 20px;
				text-align: center;
			}
			.gallery-hero h1 {
				font-size: 42px;
				margin: 0 0 10px 0;
			}
			.gallery-hero p {
				font-size: 18px;
				opacity: 0.95;
				max-width: 800px;
				margin: 0 auto;
			}

			/* Filter Buttons */
			.filter-container {
				text-align: center;
				padding: 30px 20px;
				display: flex;
				justify-content: center;
				flex-wrap: wrap;
				gap: 12px;
			}
			.filter-btn {
				padding: 0px 20px;
				border: 2px solid #ddd;
				background: white;
				border-radius: 25px;
				cursor: pointer;
				transition: all 0.3s ease;
				font-weight: 500;
				color: #666;
			}
			.filter-btn:hover,
			.filter-btn.active {
				background: linear-gradient(90deg, #667eea, #764ba2);
				color: white;
				border-color: #667eea;
			}

			/* Gallery Grid */
			.gallery-container {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
				gap: 20px;
				padding: 40px 20px;
				max-width: 1400px;
				margin: 0 auto;
			}

			/* Gallery Item */
			.gallery-item {
				position: relative;
				overflow: hidden;
				border-radius: 15px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				cursor: pointer;
				aspect-ratio: 1 / 1;
				background: linear-gradient(135deg, #667eea, #764ba2);
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 80px;
				transition: all 0.3s ease;
			}

			.gallery-item:hover {
				transform: scale(1.05);
				box-shadow: 0 20px 50px rgba(102, 126, 234, 0.3);
			}

			.gallery-item-image {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}

			.gallery-item-overlay {
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				opacity: 0;
				transition: all 0.3s ease;
				color: white;
				text-align: center;
				padding: 20px;
			}

			.gallery-item:hover .gallery-item-overlay {
				opacity: 1;
			}

			.overlay-title {
				font-size: 22px;
				font-weight: bold;
				margin-bottom: 10px;
			}

			.overlay-desc {
				font-size: 14px;
				opacity: 0.9;
			}

			/* Modal */
			.modal {
				display: none;
				position: fixed;
				z-index: 1000;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				overflow: auto;
				background-color: rgba(0, 0, 0, 0.8);
				animation: fadeIn 0.3s ease;
			}

			@keyframes fadeIn {
				from { opacity: 0; }
				to { opacity: 1; }
			}

			.modal-content {
				margin: 5% auto;
				width: 90%;
				max-width: 900px;
				background: white;
				border-radius: 15px;
				overflow: hidden;
				box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
				animation: slideIn 0.3s ease;
			}

			@keyframes slideIn {
				from {
					transform: translateY(-50px);
					opacity: 0;
				}
				to {
					transform: translateY(0);
					opacity: 1;
				}
			}

			/* Upload form styles */
			.upload-section {padding: 30px 20px; max-width: 980px; margin: 30px auto; text-align: center;}
			.upload-form {display:flex; gap:12px; flex-wrap:wrap; justify-content:center; align-items:center;}
			.upload-form input[type="file"] {padding:6px;}
			.upload-form input[type="password"], .upload-form input[type="text"], .upload-form select {padding:8px 10px; border-radius:6px; border:1px solid #ddd;}
			.upload-form button {padding:10px 16px; border-radius:8px; background: linear-gradient(90deg,#667eea,#764ba2); color:#fff; border:0; cursor:pointer}
			.upload-msg {margin-top:10px; font-size:14px}
			.upload-msg.error {color:#c0392b}
			.upload-msg.success {color:#27ae60}

			.modal-image {
				width: 100%;
				max-height: 500px;
				object-fit: cover;
				background: linear-gradient(135deg, #667eea, #764ba2);
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 120px;
				color: white;
			}

			.modal-body {
				padding: 30px;
			}

			.modal-body h2 {
				margin-top: 0;
				color: #333;
			}

			.close {
				position: absolute;
				right: 20px;
				top: 20px;
				font-size: 32px;
				font-weight: bold;
				color: white;
				cursor: pointer;
				background: rgba(0, 0, 0, 0.5);
				width: 50px;
				height: 50px;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.3s ease;
				z-index: 10;
			}

			.close:hover {
				background: rgba(0, 0, 0, 0.8);
			}

			/* Stats */
			.gallery-stats {
				background: #f5f5f5;
				padding: 40px 20px;
				text-align: center;
			}

			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
				gap: 30px;
				max-width: 1000px;
				margin: 0 auto;
			}

			.stat-item h3 {
				font-size: 36px;
				color: #667eea;
				margin: 0;
			}

			.stat-item p {
				color: #666;
				margin: 10px 0 0 0;
			}

			@media (max-width: 768px) {
				.gallery-container {
					grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
					gap: 15px;
					padding: 20px 15px;
				}

				.gallery-hero h1 {
					font-size: 30px;
				}

				.modal-content {
					width: 95%;
					margin: 20% auto;
				}
			}
		</style>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
		<div id="page-wrapper">

			<!-- Header -->
			<header id="header">
				<h1><a href="index.html">Zhetysai Ibilim 10C</a></h1>
				<nav id="nav">
					<ul>
						<li class="special">
							<a href="#menu" class="menuToggle"><span>Menu</span></a>
							<div id="menu">
								<ul>
									<li><a href="index.html">Home - –ú–µ–Ω—é</a></li>
											<li><a href="student and teachers.html">Students and Teachers</a></li>
											
											<li><a href="gallery.html">Gallery</a></li>
								</ul>
							</div>
						</li>
					</ul>
				</nav>
			</header>

			<!-- Hero Section -->
			<section class="gallery-hero">
				<h1>üì∏ –°—É—Ä–µ—Ç—Ç–µ—Ä —Ç–æ–ø—Ç–∞–º–∞—Å—ã 10C</h1>
				<p>
					–ë“±–ª –±—ñ–∑–¥—ñ“£ —Å—ã–Ω—ã–ø—Ç—ã“£ –µ“£ –∂–∞“õ—Å—ã —Å”ô—Ç—Ç–µ—Ä—ñ–Ω –∫”©—Ä—Å–µ—Ç–µ—Ç—ñ–Ω —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è. –ú“±–Ω–¥–∞ –±—ñ–∑ –±—ñ—Ä–≥–µ ”©—Ç–∫—ñ–∑–≥–µ–Ω —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä, –∂–æ–±–∞–ª–∞—Ä –∂”ô–Ω–µ –∫”©“£—ñ–ª–¥—ñ —Å”ô—Ç—Ç–µ—Ä—ñ–º—ñ–∑–¥—ñ“£ —Å—É—Ä–µ—Ç—Ç–µ—Ä—ñ –±–∞—Ä. ”ò—Ä–±—ñ—Ä —Ñ–æ—Ç–æ –±—ñ–∑–¥—ñ“£ –±—ñ—Ä–ª—ñ–≥—ñ–º—ñ–∑ –±–µ–Ω –¥–æ—Å—Ç—ã“ì—ã–º—ã–∑–¥—ã –∫”©—Ä—Å–µ—Ç–µ–¥—ñ. –¢”©–º–µ–Ω–¥–µ–≥—ñ —Å“Ø–∑–≥—ñ–ª–µ—Ä–¥—ñ –ø–∞–π–¥–∞–ª–∞–Ω—ã–ø, ”ô—Ä—Ç“Ø—Ä–ª—ñ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–ª–∞—Ä –±–æ–π—ã–Ω—à–∞ —Å—É—Ä–µ—Ç—Ç–µ—Ä–¥—ñ “õ–∞—Ä–∞“£—ã–∑!
				</p>
			</section>

			<!-- Filter Section -->
			<div class="filter-container">
				<button class="filter-btn " onclick="filterGallery('events', this)">üéâ –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä</button>
				<button class="filter-btn " onclick="filterGallery('study', this)">üìö –û“õ—É</button>
				<button class="filter-btn" onclick="filterGallery('projects', this)">üöÄ –ñ–æ–±–∞–ª–∞—Ä</button>
				<button class="filter-btn" onclick="filterGallery('fun', this)">üòÑ –ö”©“£—ñ–ª–¥—ñ</button>
			</div>

			<!-- Main Content -->
			<article id="main">
				
				<div class="gallery-container" id="gallery">
					<!-- Event 1 -->
					<div class="gallery-item" data-category="events" onclick="openModal(this)">
						<div>üéâ</div>
						<div class="gallery-item-overlay">
							
						</div>
					</div>

					<!-- Event 2 -->

					<!-- Study 1 -->
					<div class="gallery-item" data-category="study" onclick="openModal(this)">
						<div>üìö</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–û–ª–∏–º–ø–∏–∞–¥–∞</div>
							<div class="overlay-desc">–£—á–∞—Å—Ç–∏–µ –≤ –Ω–∞—É—á–Ω–æ–º –∫–æ–Ω–∫—É—Ä—Å–µ</div>
						</div>
					</div>

					<!-- Study 2 -->
					<div class="gallery-item" data-category="study" onclick="openModal(this)">
						<div>‚úèÔ∏è</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–ó–∞–Ω—è—Ç–∏—è</div>
							<div class="overlay-desc">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–∫–∏ –≤ –∫–ª–∞—Å—Å–µ</div>
						</div>
					</div>

					<!-- Project 1 -->
					<div class="gallery-item" data-category="projects" onclick="openModal(this)">
						<div>üíª</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–í–µ–±-–ø—Ä–æ–µ–∫—Ç</div>
							<div class="overlay-desc">–°–æ–∑–¥–∞–Ω–∏–µ —à–∫–æ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞</div>
						</div>
					</div>

					<!-- Project 2 -->
					<div class="gallery-item" data-category="projects" onclick="openModal(this)">
						<div>ü§ñ</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">IT-–ø—Ä–æ–µ–∫—Ç</div>
							<div class="overlay-desc">–†–∞–±–æ—Ç–∞ –Ω–∞–¥ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–æ–π</div>
						</div>
					</div>

					<!-- Fun 1 -->
					<div class="gallery-item" data-category="fun" onclick="openModal(this)">
						<div>üòÑ</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–°–µ–ª—Ñ–∏ –∫–ª–∞—Å—Å–∞</div>
							<div class="overlay-desc">–í–µ—Å–µ–ª—ã–π –º–æ–º–µ–Ω—Ç —Å –¥—Ä—É–∑—å—è–º–∏</div>
						</div>
					</div>

					<!-- Fun 2 -->
					

					<!-- Event 3 -->
					

					<!-- Study 3 -->
					<div class="gallery-item" data-category="study" onclick="openModal(this)">
						<div>üß™</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
							<div class="overlay-desc">–ù–∞—É—á–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –æ–ø—ã—Ç—ã</div>
						</div>
					</div>

					<!-- Project 3 -->
					<div class="gallery-item" data-category="projects" onclick="openModal(this)">
						<div>üé®</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–î–∏–∑–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç</div>
							<div class="overlay-desc">–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∞</div>
						</div>
					</div>

					<!-- Fun 3 -->
					<div class="gallery-item" data-category="fun" onclick="openModal(this)">
						<div>üé∏</div>
						<div class="gallery-item-overlay">
							<div class="overlay-title">–ö–æ–Ω—Ü–µ—Ä—Ç</div>
							<div class="overlay-desc">–¢–∞–ª–∞–Ω—Ç-—à–æ—É –≤ —à–∫–æ–ª–µ</div>
						</div>
					</div>
				</div>
			</article>

			<!-- Stats Section -->

			<!-- Add Image (requires password) -->
			<section class="upload-section">
				<h2>
					üì§ ”®–∑—ñ–º–Ω—ñ“£ —Ç–µ–ª–µ—Ñ–æ–Ω—ã–º –∞—Ä“õ—ã–ª—ã —Å—É—Ä–µ—Ç
				</h2>
				<form id="uploadForm" class="upload-form" onsubmit="handleAddImageSubmit(event)">
					<input type="file" id="uploadFile" accept="image/*" required />
					<input type="text" id="uploadTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" required />
					<select id="uploadCategory">
						<option value="events">üéâ –Ü—Å-—à–∞—Ä–∞–ª–∞—Ä</option>
						<option value="study">üìö –û“õ—É</option>
						<option value="projects">üöÄ –ñ–æ–±–∞–ª–∞—Ä</option>
						<option value="fun">üòÑ –ö”©“£—ñ–ª–¥—ñ</option>
					</select>
					<input type="password" id="uploadPassword" placeholder="–ü–∞—Ä–æ–ª—å" required />
					<label style="display:flex; align-items:center; gap:8px;">
						<input type="checkbox" id="uploadToServer" />
						<span style="font-size:13px;">
							
						</span>
					</label>
					<button type="submit" style="padding: 0px 20px;text-align: center;">“ö–æ—Å—É</button>
				</form>
				<div id="uploadMsg" class="upload-msg" aria-live="polite"></div>
			</section>


			<!-- Modal -->
			<div id="imageModal" class="modal">
				<div class="modal-content">
					<span class="close" onclick="closeModal()">&times;</span>
					<div class="modal-image" id="modalImage">
						<div style="font-size: 120px;">üì∏</div>
					</div>
					<div class="modal-body">
						<h2 id="modalTitle">–§–æ—Ç–æ</h2>
						<p id="modalDesc">–°—É—Ä–µ—Ç —Å–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã</p>
					</div>
				</div>
			</div>

			<!-- Footer -->
			<footer id="footer">
				<ul class="icons">
					<li><span style="text-align:center; display:block; color:#666">–°–æ—Ü—Å–µ—Ç–∏ —Å–∫—Ä—ã—Ç—ã</span></li>
				</ul>
				<ul class="copyright">
					<li>&copy; Zhetysai Ibilim 10C</li><li> Year: 2025-2026</li>
				</ul>
			</footer>


		</div>

		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>

		<!-- Gallery Script -->
		<script>
			function filterGallery(category, btn) {
				const items = document.querySelectorAll('.gallery-item');
				const btns = document.querySelectorAll('.filter-btn');

				// Update button styles
				btns.forEach(b => b.classList.remove('active'));
				if (btn && btn.classList) {
					btn.classList.add('active');
				} else {
					// fallback: try to find a button whose onclick contains the category
					const fallback = Array.from(btns).find(b => b.getAttribute('onclick') && b.getAttribute('onclick').indexOf(category) !== -1);
					if (fallback) fallback.classList.add('active');
				}

				// Filter items
				items.forEach(item => {
					if (category === 'all' || item.getAttribute('data-category') === category) {
						item.style.display = 'flex';
					} else {
						item.style.display = 'none';
					}
				});
			}

			function openModal(element) {
				const modal = document.getElementById('imageModal');
				const overlay = element.querySelector('.gallery-item-overlay');
				const title = overlay.querySelector('.overlay-title').textContent;
				const desc = overlay.querySelector('.overlay-desc').textContent;
				const emoji = element.querySelector('div').textContent;

				document.getElementById('modalTitle').textContent = title;
				document.getElementById('modalDesc').textContent = desc;
				document.getElementById('modalImage').textContent = emoji;
				document.getElementById('modalImage').style.fontSize = '100px';
				document.getElementById('modalImage').style.display = 'flex';
				document.getElementById('modalImage').style.alignItems = 'center';
				document.getElementById('modalImage').style.justifyContent = 'center';

				modal.style.display = 'block';
			}

			function closeModal() {
				document.getElementById('imageModal').style.display = 'none';
			}

			window.onclick = function(event) {
				const modal = document.getElementById('imageModal');
				if (event.target === modal) {
					modal.style.display = 'none';
				}
			}

			// --- Upload with password (client-side) ---
			const UPLOAD_PASSWORD = 'ibilim2025'; // change this value if you want a different password

			function handleAddImageSubmit(e) {
				e.preventDefault();
				const pwd = document.getElementById('uploadPassword').value;
				const msgEl = document.getElementById('uploadMsg');
				if (pwd !== UPLOAD_PASSWORD) {
					msgEl.textContent = '“ö–∞—Ç–µ –ø–∞—Ä–æ–ª—å. –°—É—Ä–µ—Ç—Ç—ñ “õ–æ—Å—É –º“Ø–º–∫—ñ–Ω –µ–º–µ—Å.';
					msgEl.className = 'upload-msg error';
					return;
				}

				const fileInput = document.getElementById('uploadFile');
				if (!fileInput.files || fileInput.files.length === 0) {
					msgEl.textContent = '”®—Ç—ñ–Ω—ñ—à, —Å—É—Ä–µ—Ç—Ç—ñ —Ç–∞“£–¥–∞“£—ã–∑.';
					msgEl.className = 'upload-msg error';
					return;
				}

				const file = fileInput.files[0];
				const reader = new FileReader();
				reader.onload = function(ev) {
					const dataUrl = ev.target.result;
					const title = document.getElementById('uploadTitle').value || '–§–æ—Ç–æ';
					const category = document.getElementById('uploadCategory').value || 'fun';

					// Create gallery item
					const el = document.createElement('div');
					el.className = 'gallery-item';
					el.setAttribute('data-category', category);
					el.setAttribute('onclick', 'openModal(this)');

					const img = document.createElement('img');
					img.className = 'gallery-item-image';
					img.src = dataUrl;

					const overlay = document.createElement('div');
					overlay.className = 'gallery-item-overlay';
					overlay.innerHTML = '<div class="overlay-title">'+escapeHtml(title)+'</div><div class="overlay-desc">–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</div>';

					el.appendChild(img);
					el.appendChild(overlay);

					const gallery = document.getElementById('gallery');
					gallery.insertBefore(el, gallery.firstChild);

					// Save to localStorage
					saveImageToLocal({src: dataUrl, title: title, category: category, addedAt: Date.now()});

					msgEl.textContent = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ.';
					msgEl.className = 'upload-msg success';
					// reset form
					document.getElementById('uploadForm').reset();

					// If user requested server upload, attempt it (non-blocking)
					if (document.getElementById('uploadToServer').checked) {
						// Use FormData to send original file to server endpoint '/upload' (Node) or 'upload.php' (PHP)
						uploadFileToServer(file, document.getElementById('uploadPassword').value)
							.then(res => {
								console.log('Server upload response', res);
								// optionally show message
								if (res && res.ok) {
									msgEl.textContent = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.';
									msgEl.className = 'upload-msg success';
								}
							})
							.catch(err => {
								console.warn('Server upload failed', err);
								msgEl.textContent = '–õ–æ–∫–∞–ª—å–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ, –Ω–æ –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ —É–¥–∞–ª–∞—Å—å.';
								msgEl.className = 'upload-msg error';
							});
					}
				};
				reader.readAsDataURL(file);
			}

			// Local storage helpers
			function getSavedImages() {
				try {
					const raw = localStorage.getItem('class_gallery_images');
					return raw ? JSON.parse(raw) : [];
				} catch (e) {
					console.warn('Failed to parse saved images', e);
					return [];
				}
			}

			function saveImageToLocal(obj) {
				const list = getSavedImages();
				list.unshift(obj);
				try {
					localStorage.setItem('class_gallery_images', JSON.stringify(list));
				} catch (e) {
					console.warn('Failed to save to localStorage', e);
				}
			}

			function loadSavedImages() {
				const list = getSavedImages();
				const gallery = document.getElementById('gallery');
				if (!gallery) return;
				list.forEach(item => {
					const el = document.createElement('div');
					el.className = 'gallery-item';
					el.setAttribute('data-category', item.category || 'fun');
					el.setAttribute('onclick', 'openModal(this)');

					const img = document.createElement('img');
					img.className = 'gallery-item-image';
					img.src = item.src;

					const overlay = document.createElement('div');
					overlay.className = 'gallery-item-overlay';
					overlay.innerHTML = '<div class="overlay-title">'+escapeHtml(item.title || '–§–æ—Ç–æ')+'</div><div class="overlay-desc">–î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ</div>';

					el.appendChild(img);
					el.appendChild(overlay);
					gallery.insertBefore(el, gallery.firstChild);
				});
			}

			// Attempt to upload original File to server endpoint using fetch + FormData
			function uploadFileToServer(file, password) {
				return new Promise((resolve, reject) => {
					try {
						const fd = new FormData();
						fd.append('image', file);
						fd.append('password', password);
						// By default try Node.js endpoint '/upload'
						fetch('/upload', {method: 'POST', body: fd})
							.then(r => r.json())
							.then(json => resolve(json))
							.catch(err => {
								// try PHP fallback
								fetch('upload.php', {method:'POST', body: fd})
									.then(r=>r.json()).then(json=>resolve(json)).catch(err2=>reject(err2));
							});
					} catch (e) { reject(e); }
				});
			}

			// Load saved images and set default filter on start
			window.addEventListener('DOMContentLoaded', function() {
				loadSavedImages();
				// Default to the first filter button (usually 'events')
				const firstBtn = document.querySelector('.filter-container .filter-btn');
				if (firstBtn) {
					filterGallery('events', firstBtn);
				}
			});

			function escapeHtml(str) {
				return str.replace(/[&<>"']/g, function(m) { return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
			}
		</script>

	</body>
</html>
